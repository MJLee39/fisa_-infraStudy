<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layouts/layout}">
<head>
  <meta charset="UTF-8">
  <title>commentReadForm.html</title>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
<div layout:fragment="content">
  <div class="w3-main" style="margin-left:300px">
    <div th:replace="header :: header"></div>
    <div id="commentsContainer" th:fragment="commentList">
      <table>
        <thead>
        <tr>
          <th>댓글 내용</th>
          <th>작성자</th>
          <th>작성일</th>
          <!-- Add more headers if needed -->
        </tr>
        </thead>
        <tbody>
        <!-- Thymeleaf에서 서버에서 받아온 댓글 데이터를 반복하여 표시 -->
        <tr th:each="comment : ${comments}">
          <td th:text="${comment.content}"></td>
          <td th:text="${comment.loginId}"></td>
          <td th:text="${comment.createdAt}"></td>
          <!-- Add more fields if needed -->
        </tr>
        </tbody>
      </table>
    </div>
    <!-- 댓글 조회 버튼 삭제 -->
  </div>
</div>

<script th:inline="javascript">
  $(document).ready(function () {
      $.ajax({
        url: "/comment/read",
        type: "GET",
        data: {boardId: 1},
        success: function (data) {
          console.log(data);
          var commentsContainer = $("#commentsContainer");
          commentsContainer.empty();

          if (data.length > 0) {
            var table = $("<table>");
            table.append("<thead><tr><th>댓글 내용</th><th>작성자</th><th>작성일</th></tr></thead>");
            var tbody = $("<tbody>");

            $.each(data, function (index, comment) {
              var row = $("<tr>");
              row.append("<td>" + comment.content + "</td>");
              row.append("<td>" + comment.loginId + "</td>");
              row.append("<td>" + comment.createdAt + "</td>");

              // 필요한 경우 추가 필드를 여기에 추가

              tbody.append(row);
            });

            table.append(tbody);
            commentsContainer.append(table);
          } else {
            commentsContainer.append("<p>No comments available</p>");
          }
        },
        error: function (error) {
          console.error("댓글 로딩 중 에러: " + error.responseText);
        }
    });
  });

</script>

</body>
</html>
